FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"bmFtZTogM3NjYWxlLWFwYgppbWFnZTogcGJyb29rZXMvM3NjYWxlLWFwYgpkZXNjcmlwdGlvbjog\
PgogIFVubG9jayB0aGUgcG93ZXIgb2YgeW91ciBBUElzLiBUaGlzIHdpbGwgZGVwbG95IEFwaWNh\
c3QgdG8geW91ciBPcGVuc2hpZnQgY2x1c3RlciBhbmQgY29ubmVjdCAKICBpdCB0byBhIGRlZGlj\
YXRlZCBSZWRpcy4gRm9yIHRoaXMgdG8gZnVuY3Rpb24gY29ycmVjdGx5IGl0IG5lZWRzIHRvIGJl\
IGNvbmZpZ3VyZWQgd2l0aCBhIHRva2VuCiAgYW5kIGRvbWFpbiBmb3IgdGhlIGFjY291bnQgaXQg\
c2hvdWxkIHB1bGwgaXQncyBjb25maWd1cmF0aW9uIHZhbHVlcyBmcm9tICh1c3VhbGx5IGluIDNz\
Y2FsZS5uZXQpLgoKICBZb3UgY2FuIGNyZWF0ZSBhbiBhY2NvdW50IHdpdGggM3NjYWxlLm5ldCBo\
ZXJlOiBodHRwczovL3d3dy4zc2NhbGUubmV0L3NpZ251cC8KYmluZGFibGU6IEZhbHNlCmFzeW5j\
OiBvcHRpb25hbAp0YWdzOgogIC0gbW9iaWxlLXNlcnZpY2UKbWV0YWRhdGE6CiAgZGlzcGxheU5h\
bWU6IDNTY2FsZQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogZmEgZmEtc3VwZXJw\
b3dlcnMKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogRGVwbG95IDNT\
Y2FsZQogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOgogICAg\
LSBuYW1lOiBUSFJFRVNDQUxFX0RPTUFJTgogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBkZWZh\
dWx0OiAKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiAzU2NhbGUgZG9tYWluIG5hbWUs\
IGkuZS4gImV4YW1wbGUtYWRtaW4uM3NjYWxlLm5ldCIKICAgIC0gbmFtZTogVEhSRUVTQ0FMRV9B\
Q0NFU1NfVE9LRU4KICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVmYXVsdDogCiAgICAgIHR5\
cGU6IHN0cmluZwogICAgICB0aXRsZTogM1NjYWxlIGFjY2VzcyB0b2tlbiAoaHR0cHM6Ly9zdXBw\
b3J0LjNzY2FsZS5uZXQvZG9jcy9hY2NvdW50cy90b2tlbnMjY3JlYXRpbmctYWNjZXNzLXRva2Vu\
cykKICAgIC0gbmFtZTogVEhSRUVTQ0FMRV9FTkFCTEVfQ09SUwogICAgICByZXF1aXJlZDogVHJ1\
ZQogICAgICBkZWZhdWx0OiBUcnVlCiAgICAgIHR5cGU6IGJvb2wKICAgICAgdGl0bGU6IEVuYWJs\
ZSBDT1JTIDNTY2FsZSBwbHVnaW4/Cgo="


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
