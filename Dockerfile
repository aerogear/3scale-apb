FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"bmFtZTogM3NjYWxlLWFwYgppbWFnZTogcGJyb29rZXMvM3NjYWxlLWFwYgpkZXNjcmlwdGlvbjog\
PgogIFVubG9jayB0aGUgcG93ZXIgb2YgeW91ciBBUElzLiBUaGlzIHdpbGwgZGVwbG95IEFwaWNh\
c3QgdG8geW91ciBPcGVuc2hpZnQgY2x1c3RlciBhbmQgY29ubmVjdCAKICBpdCB0byBhIGRlZGlj\
YXRlZCBSZWRpcy4gRm9yIHRoaXMgdG8gZnVuY3Rpb24gY29ycmVjdGx5IGl0IG5lZWRzIHRvIGJl\
IGNvbmZpZ3VyZWQgd2l0aCBhIHRva2VuCiAgYW5kIGRvbWFpbiBmb3IgdGhlIGFjY291bnQgaXQg\
c2hvdWxkIHB1bGwgaXQncyBjb25maWd1cmF0aW9uIHZhbHVlcyBmcm9tICh1c3VhbGx5IGluIDNz\
Y2FsZS5uZXQpLgoKICBZb3UgY2FuIGNyZWF0ZSBhbiBhY2NvdW50IHdpdGggM3NjYWxlLm5ldCBo\
ZXJlOiBodHRwczovL3d3dy4zc2NhbGUubmV0L3NpZ251cC8KYmluZGFibGU6IEZhbHNlCmFzeW5j\
OiBvcHRpb25hbAp0YWdzOgogIC0gbW9iaWxlLXNlcnZpY2UKbWV0YWRhdGE6CiAgZGlzcGxheU5h\
bWU6IDNTY2FsZQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogZmEgZmEtc3VwZXJw\
b3dlcnMKICBzZXJ2aWNlTmFtZTogM3NjYWxlCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAg\
ZGVzY3JpcHRpb246IERlcGxveSAzU2NhbGUKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7\
fQogICAgcGFyYW1ldGVyczoKICAgIC0gbmFtZTogVEhSRUVTQ0FMRV9ET01BSU4KICAgICAgcmVx\
dWlyZWQ6IFRydWUKICAgICAgZGVmYXVsdDogCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRs\
ZTogM1NjYWxlIGRvbWFpbiBuYW1lLCBpLmUuICJleGFtcGxlLWFkbWluLjNzY2FsZS5uZXQiCiAg\
ICAtIG5hbWU6IFRIUkVFU0NBTEVfQUNDRVNTX1RPS0VOCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAg\
ICAgIGRlZmF1bHQ6IAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IDNTY2FsZSBhY2Nl\
c3MgdG9rZW4gKGh0dHBzOi8vc3VwcG9ydC4zc2NhbGUubmV0L2RvY3MvYWNjb3VudHMvdG9rZW5z\
I2NyZWF0aW5nLWFjY2Vzcy10b2tlbnMpCiAgICAtIG5hbWU6IFRIUkVFU0NBTEVfRU5BQkxFX0NP\
UlMKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVmYXVsdDogVHJ1ZQogICAgICB0eXBlOiBi\
b29sCiAgICAgIHRpdGxlOiBFbmFibGUgQ09SUyAzU2NhbGUgcGx1Z2luPwoK"


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
